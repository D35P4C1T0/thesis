\documentclass[a4paper, 11pt, titlepage, twoside, openany]{book}
\usepackage{plain}
\usepackage{setspace}
% Layout
\usepackage[
  paperheight=29.7cm,
  paperwidth=21cm,
  outer=1.5cm,
  inner=2.5cm,
  top=2cm,
  bottom=2cm
]{geometry}
% Chapter
\usepackage{titlesec}
\singlespacing
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
% Letter
\usepackage[utf8]{inputenc}
% Language
\usepackage[italian]{babel}

% load xcolor before pdfx to avoid errors
\usepackage{xcolor}

% minimal TOC
\usepackage{tocloft}
\renewcommand{\cftaftertoctitle}{\vspace{-1em}}
\setlength{\cftbeforechapskip}{0pt}
\setlength{\cftbeforesecskip}{0pt}
\setlength{\cftbeforetoctitleskip}{-1em}
\setlength{\cftaftertoctitleskip}{0.5em}
\setlength{\cftparskip}{0pt}
\setlength{\cftpartnumwidth}{1.5em}
\setlength{\cftsecindent}{0pt}
\setlength{\cftsecnumwidth}{1.5em}
\renewcommand{\cftsecfont}{\small}
\renewcommand{\cftsubsecfont}{\footnotesize}
\renewcommand{\cftdotsep}{1}

% PDF/A
\usepackage[a-1b]{pdfx}
% Image
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{stackengine}
\usepackage{etoolbox}
\BeforeBeginEnvironment{wrapfigure}{\setlength{\intextsep}{0pt}}
% Hyperlink
\usepackage{xurl}
\usepackage[pdfa]{hyperref}
\hypersetup{breaklinks=true}
% List
\usepackage{enumitem}

% START: DELETE ME
\usepackage{lipsum}
% END: DELETE ME

% csv tabella
\usepackage{csvsimple}

\usepackage{booktabs}
\usepackage{siunitx}
\sisetup{
    output-exponent-marker=\ensuremath{\mathrm{E}},
    exponent-product={},
    retain-explicit-plus
}

% Snippet di codice
\usepackage{listings}

% Grafici
\usepackage{pgfplots}
\usepackage{siunitx}

% Impostazioni per pgfplots
\pgfplotsset{compat=1.18} % Usa una versione recente di pgfplots
\usepgfplotslibrary{groupplots} % Per grafici multipli
\usepgfplotslibrary{statistics}

% short space character fix
% \DeclareUnicodeCharacter{202F}{FIX ME!!!!}

\usepackage{subcaption}  % Add to preamble
\usepackage{caption}

% better quotes
\usepackage{dirtytalk}


\newenvironment{longlisting}{\captionsetup{type=listing}}{}

% code snipper syntax highlight
\usepackage{minted}
% minted style
\usemintedstyle{manni}

\setminted{
    linenos=true,
    breaklines=true,
    autogobble=true,
    frame=lines,
    framesep=2mm,
    fontsize=\footnotesize,  % <-- smaller than \small
    % fontseries=tt,
    obeytabs=true,
    tabsize=4,
}


% \usepackage{parskip}
% \setlength{\parskip}{3pt plus1pt minus1pt}

% Document
\begin{document}
  % Cover
  \pagenumbering{gobble}
  \input{etc/cover}
  \clearpage

  % Acknowledgements
  \input{etc/acknowledgements}
  \clearpage
  \pagestyle{plain}

  % Table of Contents
  \frontmatter
  \pagenumbering{Roman}
  \tableofcontents
  \clearpage
  \begingroup
  \pagestyle{empty}
  \cleardoublepage
  \endgroup

  % Start page numbering
  \mainmatter

  % Group to define space between chapters
  \begingroup
  % Override format of title chapter
  \titleformat{\chapter} {\normalfont\Huge\bfseries}{\thechapter}{1em}{} \titlespacing*{\chapter}{0pt}{0.59in}{0.02in}
  \titlespacing*{\section}{0pt}{0.20in}{0.02in} \titlespacing*{\subsection}{0pt}{0.10in}{0.02in}
  \titlespacing*{\subsubsection}{0pt}{0.05in}{0.02in}

  % Abstract
  \input{etc/abstract.tex}

  % Chapters

  \input{chapters/MNAT/mnat}
  \input{chapters/introduzione}
  \input{chapters/analisi-mappe}
  \input{chapters/implementazione}
  \input{etc/conclusions.tex}

  \endgroup

% Bibliography
\cleardoublepage
\phantomsection
\addcontentsline{toc}{chapter}{Bibliography}

\begingroup
  \footnotesize                        % shrink font
  \setlength{\parskip}{0pt}     % no extra space between items
  \setlength{\itemsep}{4pt}     % compact list items
  \renewcommand{\baselinestretch}{0.65}\normalsize % tighten line spacing
  
  \bibliographystyle{plain}
  \bibliography{bibliography.bib}
\endgroup


  % Attachments
  % \titleformat{\chapter} {\normalfont\Huge\bfseries}{Appendix \thechapter}{1em}{}
  % \appendix
  % \input{chapters/geojson}
\end{document}